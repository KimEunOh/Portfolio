# Form Selector 프로젝트 개요

이 문서는 `form-selector` 프로젝트의 전체적인 구조와 아키텍처, 그리고 각 디렉터리와 파일의 역할에 대해 상세히 설명합니다. 이 문서는 프로젝트의 신규 참여자가 빠르게 구조를 파악하거나, 기존 참여자가 특정 기능의 위치를 찾는 데 도움을 주는 것을 목표로 합니다.

## 1. 아키텍처 다이어그램

아래 다이어그램은 프로젝트의 주요 구성 요소와 데이터 흐름을 시각적으로 나타냅니다. 사용자가 프론트엔드에서 양식 데이터를 제출하면, 백엔드 서버의 서비스 계층을 거쳐 각 양식에 맞는 처리기가 동작합니다. 처리기는 LLM을 사용하여 데이터를 추출하고, 도메인 모델을 통해 비즈니스 로직을 처리한 후, 인프라 계층을 통해 외부 시스템과 연동합니다.

```mermaid
graph TD
    subgraph "사용자 인터페이스 (Frontend)"
        A[Static HTML/JS Frontend]
    end

    subgraph "백엔드 서버 (Python)"
        C[Service Layer (FastAPI Endpoints)]
        D[Form Processors (양식 처리기)]
        E[LLM Integration (LLM 연동)]
        F[Domain Model (도메인 모델)]
        G[Infrastructure (외부 연동)]
    end

    subgraph "외부 시스템"
        H[Large Language Model API]
        I[Database]
    end

    A -- "1. 양식 데이터 제출 (HTTP)" --> C
    C -- "2. 서비스 로직 호출" --> D
    D -- "3. 양식 타입에 따른 처리기 선택 (Factory)" --> D
    D -- "4. 데이터 추출 요청 (Prompting)" --> E
    E -- "5. LLM API 호출" --> H
    D -- "6. 도메인 객체 활용" --> F
    D -- "7. 데이터 영속성 처리" --> G
    G -- "8. DB 통신 (CRUD)" --> I
```

## 2. 디렉터리 및 파일 상세 설명

프로젝트는 크게 프론트엔드(`static`, `templates`), 백엔드(`form_selector`), 그리고 문서 및 설정 파일로 구성됩니다.

### 2.1. 최상위 디렉터리

| 파일/디렉터리             | 역할                                                                                                 |
| ------------------------- | ---------------------------------------------------------------------------------------------------- |
| `assets/`                 | README, 프로젝트 문서 등에 사용되는 이미지와 같은 정적 자원을 저장합니다.                              |
| `documents/`              | `PROJECT_OVERVIEW.md`와 같이 프로젝트의 이해를 돕는 각종 문서를 관리합니다.                            |
| **`form_selector/`**      | **(주요) Python 기반의 핵심 백엔드 애플리케이션 로직이 포함된 메인 패키지입니다. (아래 상세 설명 참고)** |
| `static/`                 | 프론트엔드에서 사용되는 CSS, JavaScript, 이미지 등 정적 파일을 관리합니다.                             |
| `templates/`              | FastAPI가 렌더링하는 HTML 템플릿 파일들을 관리합니다. 각 파일은 특정 전자결재 양식에 해당합니다.       |
| `main.py`                 | **FastAPI 웹 애플리케이션을 실행하는 엔트리 포인트(Entry Point)입니다.**                               |
| `client_test_cases.json`  | 프론트엔드 기능 테스트를 위한 시나리오와 테스트 케이스 데이터를 정의한 JSON 파일입니다.               |
| `requirements.txt`        | 프로젝트에 필요한 Python 패키지 의존성을 명시합니다. (`pip install -r requirements.txt`)               |
| `.gitignore`              | Git 버전 관리에서 제외할 파일 및 디렉터리 패턴을 정의합니다.                                         |
| `README.md`               | 프로젝트에 대한 기본적인 소개, 설치 방법, 실행 방법 등을 안내하는 문서입니다.                         |

### 2.2. `form_selector/` (백엔드 애플리케이션)

백엔드 애플리케이션은 계층형 아키텍처(Layered Architecture)를 기반으로 설계되어, 각 모듈이 명확한 책임을 갖도록 구성되었습니다.

| 파일/디렉터리             | 역할                                                                                                                                                             |
| ------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`processors/`**         | **각 전자결재 양식(연차, 법인카드 등)의 비즈니스 로직을 실제로 처리하는 가장 핵심적인 디렉터리입니다.**                                                                |
| ├── `base_processor.py`     | 모든 양식 처리기의 공통 인터페이스와 기본 로직을 정의하는 추상 기반 클래스(Abstract Base Class)입니다.                                                            |
| ├── `processor_factory.py`  | 입력된 양식 종류(`form_type`)에 따라 해당하는 구체적인 처리기(`*\_processor.py`) 인스턴스를 생성하고 반환하는 팩토리(Factory) 클래스입니다.                        |
| ├── `*_processor.py`        | (e.g., `annual_leave_processor.py`) 특정 양식 하나에 대한 데이터 추출, 필드 변환, 유효성 검사, DB 저장 등 모든 처리 과정을 캡슐화한 클래스입니다.                  |
| **`converters/`**         | **LLM이 추출한 텍스트 데이터를 시스템에서 사용 가능한 형태로 변환하는 역할을 담당합니다.**                                                                             |
| ├── `date_converter.py`     | "2023년 5월 10일"과 같은 비정형 날짜 문자열을 `YYYY-MM-DD` 형식으로 변환합니다.                                                                                   |
| ├── `field_converter.py`    | 특정 필드(e.g., 금액, 인원수)의 텍스트를 숫자나 정해진 형식의 데이터로 변환합니다.                                                                                 |
| ├── `item_converter.py`     | 품목 리스트와 같이 여러 항목으로 구성된 데이터를 파싱하고 구조화된 객체로 변환합니다.                                                                            |
| **`prompts/`**            | **LLM에게 원하는 정보를 추출하도록 지시하는 프롬프트 템플릿 파일(`*.txt`)을 관리합니다.**                                                                              |
| ├── `form_classifier_prompt.txt` | 입력된 텍스트가 어떤 종류의 양식에 해당하는지 분류하기 위한 프롬프트입니다.                                                                                    |
| ├── `*_slots_prompt.txt`    | 각 양식에서 추출해야 할 정보(슬롯, Slot)들을 정의하고, 해당 정보를 추출하도록 유도하는 프롬프트입니다.                                                              |
| `service.py`              | API 엔드포인트의 역할을 수행하며, HTTP 요청을 받아 `ProcessorFactory`를 통해 적절한 처리기를 호출하고 결과를 반환하는 등 전체적인 처리 흐름을 조정합니다.             |
| `llm.py`                  | OpenAI와 같은 외부 LLM API와 통신하는 로직을 캡슐화한 모듈입니다. 프롬프트를 전달하고 응답을 받아오는 역할을 합니다.                                                  |
| `rag.py`                  | RAG(Retrieval-Augmented Generation) 관련 로직을 포함하여, 필요시 외부 문서나 데이터를 참조하여 LLM의 답변 정확도를 향상시키는 기능을 수행할 수 있습니다.            |
| `schema.py`               | API 요청 및 응답에 사용되는 데이터 구조를 Pydantic 모델로 정의합니다. 데이터 유효성 검사와 타입 힌파이션에 사용되어 안정성을 높입니다.                                 |
| `utils.py`                | 프로젝트 전반에서 사용되는 공통 유틸리티 함수(e.g., 로깅 설정, 날짜 계산 등)를 포함합니다.                                                                        |
| `form_configs.py`         | 각 양식의 이름, 경로, 관련 설정 등 메타데이터를 정의하는 설정 파일입니다.                                                                                         |

### 2.3. `static/` & `templates/` (프론트엔드)

| 파일/디렉터리             | 역할                                                                                                                                                                                          |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `templates/*.html`        | 각 전자결재 양식의 UI를 구성하는 HTML 파일입니다. (e.g., `annual_leave.html`, `corporate_card_statement.html`)                                                                                 |
| `static/js/*.js`          | 각 HTML 페이지의 동적인 기능을 구현하는 JavaScript 파일입니다. 사용자 입력 처리, 데이터 테이블 생성, 서버와의 비동기 통신(AJAX) 등을 담당합니다. (e.g., `annual_leave_scripts_v2.js`)            |
| `static/style.css`        | 애플리케이션의 전반적인 시각적 스타일(레이아웃, 색상, 폰트 등)을 정의하는 CSS 파일입니다.                                                                                                    |
| `static/index.html`       | 사용자가 처음 마주하는 메인 페이지 또는 대시보드 역할을 하는 HTML 파일입니다.                                                                                                                   |

---

이 문서가 프로젝트를 이해하는 데 도움이 되기를 바랍니다. 코드베이스가 변경될 경우, 이 문서를 지속적으로 업데이트하여 최신 상태를 유지해야 합니다. 