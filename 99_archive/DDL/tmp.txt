-- 사용자
CREATE TABLE `tbl_user` (
	`user_pid`         bigint       NOT NULL COMMENT '사용자pid', -- 사용자pid
	`empno`            varchar(20)  NULL     COMMENT '사번', -- 사번
	`user_dv_ty`       VARCHAR(20)  NULL     COMMENT '사용자구분타입', -- 사용자구분타입
	`user_id`          varchar(50)  NULL     COMMENT '사용자ID', -- 사용자ID
	`user_password`    varchar(200) NULL     COMMENT '사용자비밀번호', -- 사용자비밀번호
	`user_nm`          varchar(50)  NULL     COMMENT '사용자명', -- 사용자명
	`use_st_ymd`       date         NULL     COMMENT '사용시작일자', -- 사용시작일자
	`use_end_ymd`      date         NULL     COMMENT '사용종료일자', -- 사용종료일자
	`tmp_password_at`  char(1)      NULL     COMMENT '임시비밀번호여부', -- 임시비밀번호여부
	`password_upd_dtm` datetime     NULL     COMMENT '패스워드수정일시', -- 패스워드수정일시
	`ctpn`             varchar(30)  NULL     COMMENT '연락처', -- 연락처
	`email`            varchar(200) NULL     COMMENT '이메일', -- 이메일
	`rmk`              LONGTEXT     NULL     COMMENT '비고', -- 비고
	`stt_ty`           VARCHAR(20)  NULL     COMMENT '상태타입', -- 상태타입
	`stt_upd_dtm`      datetime     NULL     COMMENT '상태수정일시', -- 상태수정일시
	`jcmp_ymd`         date         NULL     COMMENT '입사일자', -- 입사일자
	`retire_ymd`       date         NULL     COMMENT '퇴사일자', -- 퇴사일자
	`reg_ps_id`        varchar(50)  NULL     COMMENT '등록자ID', -- 등록자ID
	`reg_dtm`          datetime     NULL     COMMENT '등록일시', -- 등록일시
	`upd_ps_id`        varchar(50)  NULL     COMMENT '수정자ID', -- 수정자ID
	`upd_dtm`          datetime     NULL     COMMENT '수정일시', -- 수정일시
	`del_at`           char(1)      NULL     COMMENT '삭제여부', -- 삭제여부
	`grd_code`         varchar(10)  NULL     COMMENT '직급코드', -- 직급코드
	`cmpny_code`       VARCHAR(10)  NULL     COMMENT '회사코드' -- 회사코드
)
COMMENT '사용자';
 
-- 사용자
ALTER TABLE `tbl_user`
	ADD CONSTRAINT `PK_tbl_user` -- 사용자 기본키
	PRIMARY KEY (
	`user_pid` -- 사용자pid
	);
 
ALTER TABLE `tbl_user`
	MODIFY COLUMN `user_pid` bigint NOT NULL AUTO_INCREMENT COMMENT '사용자pid';
 
-- 부서정보
CREATE TABLE `tbl_department_info` (
	`dept_code`      varchar(10) NOT NULL COMMENT '부서코드', -- 부서코드
	`dept_nm`        varchar(50) NULL     COMMENT '부서명', -- 부서명
	`reg_ps_id`      varchar(50) NULL     COMMENT '등록자ID', -- 등록자ID
	`reg_dtm`        datetime    NULL     COMMENT '등록일시', -- 등록일시
	`upd_ps_id`      varchar(50) NULL     COMMENT '수정자ID', -- 수정자ID
	`upd_dtm`        datetime    NULL     COMMENT '수정일시', -- 수정일시
	`del_at`         char(1)     NULL     COMMENT '삭제여부', -- 삭제여부
	`prnt_dept_code` varchar(10) NULL     COMMENT '부모부서코드' -- 부모부서코드
)
COMMENT '부서정보';
 
-- 부서정보
ALTER TABLE `tbl_department_info`
	ADD CONSTRAINT `PK_tbl_department_info` -- 부서정보 기본키
	PRIMARY KEY (
	`dept_code` -- 부서코드
	);
 
-- 직책정보
CREATE TABLE `tbl_position_info` (
	`pst_code`  varchar(10) NOT NULL COMMENT '직책코드', -- 직책코드
	`pst_nm`    varchar(50) NULL     COMMENT '직책명', -- 직책명
	`sno`       int         NULL     COMMENT '순번', -- 순번
	`reg_ps_id` varchar(50) NULL     COMMENT '등록자ID', -- 등록자ID
	`reg_dtm`   datetime    NULL     COMMENT '등록일시', -- 등록일시
	`upd_ps_id` varchar(50) NULL     COMMENT '수정자ID', -- 수정자ID
	`upd_dtm`   datetime    NULL     COMMENT '수정일시', -- 수정일시
	`del_at`    char(1)     NULL     COMMENT '삭제여부' -- 삭제여부
)
COMMENT '직책정보';
 
-- 직책정보
ALTER TABLE `tbl_position_info`
	ADD CONSTRAINT `PK_tbl_position_info` -- 직책정보 기본키
	PRIMARY KEY (
	`pst_code` -- 직책코드
	);
 
-- 부서직책연계
CREATE TABLE `tbl_dept_pos_rel` (
	`user_pid`  bigint      NOT NULL COMMENT '사용자pid', -- 사용자pid
	`dept_code` varchar(10) NOT NULL COMMENT '부서코드', -- 부서코드
	`pst_code`  varchar(10) NULL     COMMENT '직책코드', -- 직책코드
	`gnfd_ymd`  date        NULL     COMMENT '발령일자', -- 발령일자
	`prrk`      int         NULL     COMMENT '우선순위' -- 우선순위
)
COMMENT '부서직책연계';
 
-- 부서직책연계
ALTER TABLE `tbl_dept_pos_rel`
	ADD CONSTRAINT `PK_tbl_dept_pos_rel` -- 부서직책연계 기본키
	PRIMARY KEY (
	`user_pid`,  -- 사용자pid
	`dept_code`  -- 부서코드
	);
 
-- 사용자
ALTER TABLE `tbl_user`
	ADD CONSTRAINT `FK_tbl_grade_info_TO_tbl_user` -- 직급정보 -> 사용자
	FOREIGN KEY (
	`grd_code` -- 직급코드
	)
	REFERENCES `tbl_grade_info` ( -- 직급정보
	`grd_code` -- 직급코드
	);
 
-- 사용자
ALTER TABLE `tbl_user`
	ADD CONSTRAINT `FK_tbl_company_info_TO_tbl_user` -- 회사정보 -> 사용자
	FOREIGN KEY (
	`cmpny_code` -- 회사코드
	)
	REFERENCES `tbl_company_info` ( -- 회사정보
	`cmpny_code` -- 회사코드
	);
 
-- 부서정보
ALTER TABLE `tbl_department_info`
	ADD CONSTRAINT `FK_tbl_department_info_TO_tbl_department_info` -- 부서정보 -> 부서정보
	FOREIGN KEY (
	`prnt_dept_code` -- 부모부서코드
	)
	REFERENCES `tbl_department_info` ( -- 부서정보
	`dept_code` -- 부서코드
	);
 
-- 부서직책연계
ALTER TABLE `tbl_dept_pos_rel`
	ADD CONSTRAINT `FK_tbl_department_info_TO_tbl_dept_pos_rel` -- 부서정보 -> 부서직책연계
	FOREIGN KEY (
	`dept_code` -- 부서코드
	)
	REFERENCES `tbl_department_info` ( -- 부서정보
	`dept_code` -- 부서코드
	);
 
-- 부서직책연계
ALTER TABLE `tbl_dept_pos_rel`
	ADD CONSTRAINT `FK_tbl_position_info_TO_tbl_dept_pos_rel` -- 직책정보 -> 부서직책연계
	FOREIGN KEY (
	`pst_code` -- 직책코드
	)
	REFERENCES `tbl_position_info` ( -- 직책정보
	`pst_code` -- 직책코드
	);
 
-- 부서직책연계
ALTER TABLE `tbl_dept_pos_rel`
	ADD CONSTRAINT `FK_tbl_user_TO_tbl_dept_pos_rel` -- 사용자 -> 부서직책연계
	FOREIGN KEY (
	`user_pid` -- 사용자pid
	)
	REFERENCES `tbl_user` ( -- 사용자
	`user_pid` -- 사용자pid
	);