# 골프장 회원 이용권 정보 관리 가이드 (순수이름 기반)

## 개요

회원 고유ID 체계 개선 과정에서 이용권 정보가 효과적으로 관리되어야 한다는 요구사항이 확인되었습니다. 특히 **이름과 괄호** 형식으로 구성된 회원명에서, **괄호 안의 내용과 관계없이 이름 부분과 전화번호가 같으면 동일인으로 취급**하는 것이 중요합니다. 이 가이드는 이러한 요구사항을 반영하여 이용권 정보를 효과적으로 관리하기 위한 시스템과 방법을 설명합니다.

## 1. 순수이름 기반 회원 식별

기존 시스템에서는 이름 전체(괄호 포함)와 휴대폰번호를 기준으로 회원을 식별했지만, 개선된 시스템에서는 다음과 같은 방식으로 동일 회원을 식별합니다:

1. **이름 추출**: 회원명에서 괄호 이전 부분만 추출 (예: '박민규(상무)' → '박민규')
2. **동일인 판단**: 추출된 순수이름과 휴대폰번호가 일치하면 동일인으로 취급
3. **새 ID 부여**: 동일인으로 확인된 모든 회원에게 하나의 고유회원ID 부여

이를 통해 예시와 같이 '박민규(상무)'와 '박민규(이사)'가 같은 휴대폰번호를 가진 경우 동일인으로 식별됩니다.

## 2. 생성된 파일 목록

순수이름 기반 이용권 관리 스크립트를 통해 다음 파일들이 생성되었습니다:

1. **회원_ID_매핑_순수이름.xlsx**
   - 순수이름과 휴대폰번호 기반으로 매핑된 고유회원ID 정보

2. **회원별_이용권_정보_순수이름.xlsx**
   - 시트1: 이용권상세 - 모든 회원의 모든 이용권에 대한 상세 정보
   - 시트2: 이용권보유현황 - 회원별 각 유형 이용권 보유 여부

3. **회원별_이용권_요약_순수이름.xlsx**
   - 회원별 보유 이용권 수, 이용권 목록, 회원 상태 등 요약 정보

## 3. 개선된 데이터 처리 과정

순수이름 기반 회원 식별 시스템의 처리 과정은 다음과 같습니다:

1. **순수이름 추출**: 이름(추가정보) 형식에서 이름 부분만 추출
2. **동일인 통합**: 순수이름과 휴대폰번호가 같은 회원 레코드를 하나로 통합
3. **새 ID 부여**: 통합된 회원 목록에 새로운 고유회원ID 부여 (D-YYYYMM-NNN 형식)
4. **이용권 정보 연결**: 각 회원별 이용권 정보를 새로운 고유회원ID에 연결

이를 통해 한 회원이 여러 회원번호로 등록되어 있던 문제를 해결하고 일관된 회원 정보 관리가 가능해집니다.

## 4. 이용권 현황 분석 결과

이용권 데이터 분석 결과 다음과 같은 정보가 확인되었습니다:

### 이용권 종류별 회원 수
- 타석정기권 보유 회원: 646명
- 타석쿠폰 보유 회원: 270명
- 시설정기권 보유 회원: 692명
- 시설쿠폰 보유 회원: 82명
- 예약정기권/예약쿠폰/레슨상품: 현재 데이터 없음

### 이용권 종류별 발급 수
- 시설정기권: 860개
- 타석정기권: 761개
- 타석쿠폰: 312개
- 시설쿠폰: 98개

### 이용권 상태별 통계
- 종료: 1,449개
- 이용중: 506개
- 일시정지: 46개
- 이용전: 26개
- 휴회: 4개

## 5. 순수이름 기반 이용권 검색 방법

특정 회원의 이용권 정보를 검색하기 위한 함수가 제공됩니다. 이 함수는 괄호 내용과 관계없이 순수이름 기준으로 회원을 검색합니다:

```python
# 회원 검색 함수
def search_member_subscriptions(member_id=None, name=None, phone=None):
    """
    회원ID, 이름 또는 휴대폰번호로 회원의 이용권 정보를 검색합니다.
    
    Args:
        member_id (str): 고유회원ID (예: 'D-202505-001')
        name (str): 회원 이름 - 괄호 내용과 관계없이 검색됩니다 (예: '박민규')
        phone (str): 휴대폰번호 (예: '01012345678')
        
    Returns:
        DataFrame: 검색된 회원의 이용권 정보
    """
    if member_id:
        return subscriptions_details_df[subscriptions_details_df['고유회원ID'] == member_id]
    elif name:
        # 괄호 내용과 관계없이 순수이름으로 검색
        return subscriptions_details_df[subscriptions_details_df['순수이름'].str.contains(name)]
    elif phone:
        return subscriptions_details_df[subscriptions_details_df['휴대폰번호'].str.contains(phone)]
    else:
        return pd.DataFrame()  # 빈 결과 반환
```

이 함수를 사용하면 '박민규'로 검색했을 때 '박민규', '박민규(상무)', '박민규(이사)' 등 동일한 순수이름을 가진 모든 회원의 이용권 정보가 검색됩니다.

## 6. 이용권 관리를 위한 데이터베이스 구조 제안

순수이름 기반 식별을 반영한 데이터베이스 구조를 제안합니다:

### 회원 테이블 (Members)
- 고유회원ID (PK): 'D-YYYYMM-NNN' 형식
- 순수이름: 괄호를 제외한 이름 부분
- 회원명: 원본 이름(추가정보 포함)
- 휴대폰번호
- 기본 회원 정보 (성별, 생년월일 등)
- 가입일, 상태, 최근 방문일 등

### 이용권 마스터 테이블 (SubscriptionTypes)
- 이용권유형ID (PK)
- 이용권 분류: 타석정기권, 시설정기권, 타석쿠폰 등
- 이용권 이름: 골프 1개월(남), 헬스 12개월 등
- 가격, 유효기간, 혜택 정보 등

### 회원별 이용권 테이블 (MemberSubscriptions)
- 회원이용권ID (PK): 자동증가 일련번호
- 고유회원ID (FK): 회원 테이블 참조
- 이용권유형ID (FK): 이용권 마스터 테이블 참조
- 시작일/종료일
- 이용상태: 이용중, 종료, 일시정지, 이용전, 휴회
- 결제 정보, 비고 등

### 이용 내역 테이블 (UsageHistory)
- 이용내역ID (PK): 자동증가 일련번호
- 회원이용권ID (FK): 회원별 이용권 테이블 참조
- 이용일시
- 이용 장소/서비스
- 비고

## 7. 효과적인 회원 관리 가이드라인

순수이름 기반 회원 식별을 효과적으로 활용하기 위한 가이드라인:

1. **회원명 입력 규칙**:
   - 기본 형식: 이름(추가정보)
   - 추가정보는 회원을 구분하는데 도움이 되는 정보 (직위, 소속 등)
   - 동일인은 항상 동일한 이름과 휴대폰번호 조합으로 관리

2. **이름 변경 시 주의사항**:
   - 순수이름 변경은 신중하게 (결혼 등으로 개명 시)
   - 괄호 내 추가정보 변경은 자유롭게 가능

3. **중복 회원 방지**:
   - 신규 회원 등록 시 순수이름과 휴대폰번호로 기존 회원 검색 필수
   - 동일인으로 확인된 경우 새 회원번호 발급하지 않고 기존 고유회원ID 사용

4. **휴대폰번호 변경 시**:
   - 순수이름이 같아도 휴대폰번호가 다르면 별개 회원으로 취급될 수 있으므로 주의
   - 휴대폰번호 변경 시 회원 정보 업데이트 필수

## 8. 구현 로드맵

### 1단계: 순수이름 기반 데이터 정비 (현재)
- 순수이름 추출 및 회원 통합
- 고유회원ID 재부여 (D-YYYYMM-NNN)
- 이용권 데이터 연결 및 분석

### 2단계: 데이터베이스 시스템 구축
- 순수이름 필드가 포함된 관계형 데이터베이스 설계
- 기존 엑셀 데이터 마이그레이션
- 중복 회원 확인 및 방지 로직 구현

### 3단계: 고급 기능 개발
- 통합된 회원 관리 인터페이스 개발
- 이용권 예약 및 관리 시스템 통합
- 동일 회원의 이용 패턴 분석 기능

### 4단계: 모바일/웹 연동
- 회원용 모바일 앱 개발
- 관리자용 웹 대시보드 개발
- 푸시 알림 및 자동화 기능 추가

## 결론

순수이름과 휴대폰번호를 기준으로 동일인을 식별하는 방식을 적용함으로써, 회원 관리의 일관성과 효율성이 크게 향상됩니다. 이 방식을 통해 회원이 이용권을 갱신하거나 새로운 이용권을 구매할 때마다 동일한 고유회원ID를 유지하여 회원 이력 추적과 서비스 품질 향상에 기여할 수 있습니다. 